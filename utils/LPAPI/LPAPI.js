var _0x3371=['setData','name','currentPrinter','left','clearRect','canvasGetImageData','substring','qrcode','fillRect','disconnectPeripheral','push','restore','RSSI','save','translate','globalData','canvasId','initBLE','setTextAlign','draw','barcode','deviceId','right','fillText','./BitmapPackage.js','data','canvasPutImageData','标签宽度：','length','white','log','width','rotate','center','height','setFillStyle','setFontSize','toUpperCase'];var _0x4634=function(_0x3371f2,_0x4634b6){_0x3371f2=_0x3371f2-0x0;var _0x3c4dd5=_0x3371[_0x3371f2];return _0x3c4dd5;};var dzBLE=require('./DzBLE.js');var bitmapPackage=require(_0x4634('0x18'));var barcodeWriter=require('./BarcodeWriter.js');var printWidth=0x0;var printHeight=0x0;var printOrientation=0x0;var itemOrientation=0x0;var itemHorizontalAlignment=0x0;var itemVerticalAlignment=0x0;var connectPrinterTimer;var canConnect=!![];var printPageGapType=-0x1;var printPageGapLength=0x2;var printDarkness=0x0;var printSpeed=0x0;var hasInit=![];var canvas=null;var canvasJS=null;var filePath=null;var isConnecting=![];function covert(_0x359b96){_0x359b96=_0x359b96*DPI()/25.4;_0x359b96=_0x359b96>=0x0?_0x359b96+0.1:_0x359b96-0.1;return parseInt(_0x359b96);}function DPI(){var _0xe8a85f=getApp()[_0x4634('0xf')]['currentPrinter'];var _0x559cdb=_0xe8a85f['DPI'];return _0x559cdb;}function setPrintPageGapType(_0x5cf0d5){printPageGapType=_0x5cf0d5;}function setPrintPageGapLength(_0x1a2a65){printPageGapLength=_0x1a2a65;}function setPrintDarkness(_0x52e47c){printDarkness=_0x52e47c;}function setPrintSpeed(_0x56a879){printSpeed=_0x56a879;}function setSupportPrefixs(_0x4ffebc){dzBLE['setSupportPrefixs'](_0x4ffebc);}function connectingPrinterName(){var _0x1f2af5=getApp()[_0x4634('0xf')][_0x4634('0x2')];return _0x1f2af5[_0x4634('0x1')];}function initLPAPI(){isConnecting=![];hasInit=![];}function initPrinterCenter(_0x541a82){if(hasInit){dzBLE['startScanPeripherals'](function(_0xdbf81f){_0x541a82(_0xdbf81f);});}else{dzBLE[_0x4634('0x11')](function(_0x874107){hasInit=!![];_0x541a82(_0x874107);});}}function scanedPrinters(_0x21f473){initPrinterCenter(function(_0x3ed3d5){_0x21f473(_0x3ed3d5);});}function compare(_0x113afa){return function(_0x18e12f,_0x3a354d){var _0x1249d9=_0x18e12f[_0x113afa];var _0x40ffd3=_0x3a354d[_0x113afa];return _0x40ffd3-_0x1249d9;};}function openPrinter(_0x498179,_0x2a6e5a,_0x5d6537){if(isConnecting){_0x2a6e5a();return;}initPrinterCenter(function(_0x908803){if(_0x908803[_0x4634('0x1c')]>0x0){if(_0x498179==null||_0x498179[_0x4634('0x1c')]==0x0){_0x908803['sort'](compare(_0x4634('0xc')));dzBLE['connectPeripheral'](_0x908803[0x0][_0x4634('0x15')],function(){isConnecting=!![];_0x2a6e5a();},function(){isConnecting=![];_0x5d6537();});}else{for(var _0x4a67d0=0x0;_0x4a67d0<_0x908803[_0x4634('0x1c')];_0x4a67d0++){var _0x245f20=_0x908803[_0x4a67d0];var _0x1bfcf6=_0x245f20[_0x4634('0x1')][_0x4634('0x6')](0x0,_0x498179[_0x4634('0x1c')]);if(_0x1bfcf6[_0x4634('0x25')]()==_0x498179[_0x4634('0x25')]()){dzBLE['connectPeripheral'](_0x245f20[_0x4634('0x15')]);break;}}}}else{}});}function connectingPrinterDetailInfos(){var _0x14907a=getApp()['globalData']['currentPrinter'];return _0x14907a;}function closePrinter(){dzBLE[_0x4634('0x9')]();}function startDrawLabel(_0x43f3f8,_0x5efb3e,_0x1960ca,_0x9cc227,_0x5e92da){canvas=wx['createCanvasContext'](_0x43f3f8);if(canvas==null){}else{printOrientation=_0x5e92da;printWidth=covert(_0x1960ca);printHeight=covert(_0x9cc227);itemOrientation=0x0;itemHorizontalAlignment=0x0;itemVerticalAlignment=0x0;canvasJS=_0x5efb3e;canvas[_0x4634('0x4')](0x0,0x0,canvas[_0x4634('0x1f')],canvas['height']);canvas[_0x4634('0x13')]();canvasJS[_0x4634('0x0')]({'canvasWidth':printWidth,'canvasHeight':printHeight});canvas['setFillStyle'](_0x4634('0x1d'));canvas[_0x4634('0x8')](0x0,0x0,printWidth+0x5,printHeight+0x5);canvas[_0x4634('0x23')]('black');}}function endDrawLabel(_0x2d0ca4){canvas[_0x4634('0x13')](!![],setTimeout(function(){if(printOrientation==0x0){if(_0x2d0ca4){_0x2d0ca4();}}else{wx[_0x4634('0x5')]({'canvasId':canvas[_0x4634('0x10')],'x':0x0,'y':0x0,'width':printWidth,'height':printHeight,'success'(_0x3a9ad2){var _0xb635cd=_0x3a9ad2[_0x4634('0x19')];var _0x126c17=new Array();if(printOrientation==0x5a){for(var _0x2b784=printWidth-0x1;_0x2b784>=0x0;_0x2b784--){for(var _0x563276=0x0;_0x563276<printHeight;_0x563276++){var _0x25d59e=(printWidth*_0x563276+_0x2b784)*0x4;_0x126c17['push'](_0xb635cd[_0x25d59e+0x0]);_0x126c17[_0x4634('0xa')](_0xb635cd[_0x25d59e+0x1]);_0x126c17[_0x4634('0xa')](_0xb635cd[_0x25d59e+0x2]);_0x126c17['push'](_0xb635cd[_0x25d59e+0x3]);}}var _0x403496=printWidth;printWidth=printHeight;printHeight=_0x403496;}else if(printOrientation==0xb4){for(var _0x563276=printHeight-0x1;_0x563276>=0x0;_0x563276--){for(var _0x2b784=printWidth-0x1;_0x2b784>=0x0;_0x2b784--){var _0x25d59e=(printWidth*_0x563276+_0x2b784)*0x4;_0x126c17['push'](_0xb635cd[_0x25d59e+0x0]);_0x126c17[_0x4634('0xa')](_0xb635cd[_0x25d59e+0x1]);_0x126c17['push'](_0xb635cd[_0x25d59e+0x2]);_0x126c17['push'](_0xb635cd[_0x25d59e+0x3]);}}}else if(printOrientation==0x10e){for(var _0x2b784=0x0;_0x2b784<printWidth;_0x2b784++){for(var _0x563276=printHeight-0x1;_0x563276>=0x0;_0x563276--){var _0x25d59e=(printWidth*_0x563276+_0x2b784)*0x4;_0x126c17[_0x4634('0xa')](_0xb635cd[_0x25d59e+0x0]);_0x126c17[_0x4634('0xa')](_0xb635cd[_0x25d59e+0x1]);_0x126c17[_0x4634('0xa')](_0xb635cd[_0x25d59e+0x2]);_0x126c17['push'](_0xb635cd[_0x25d59e+0x3]);}}var _0x403496=printWidth;printWidth=printHeight;printHeight=_0x403496;}canvasJS[_0x4634('0x0')]({'canvasWidth':printWidth,'canvasHeight':printHeight});var _0x2adf20=new Uint8ClampedArray(_0x126c17);wx[_0x4634('0x1a')]({'canvasId':canvas[_0x4634('0x10')],'data':_0x2adf20,'x':0x0,'y':0x0,'width':printWidth,'height':printHeight,'success'(_0x543b4d){if(_0x2d0ca4){_0x2d0ca4();}},'fail'(_0x7eafe2){console['log'](_0x7eafe2);}});}});}},0x3e8));}function print(_0x5efb16){wx['canvasGetImageData']({'canvasId':canvas[_0x4634('0x10')],'x':0x0,'y':0x0,'width':printWidth,'height':printHeight,'success'(_0x4879f4){console[_0x4634('0x1e')](_0x4634('0x1b')+_0x4879f4[_0x4634('0x1f')]);console['log']('标签高度：'+_0x4879f4[_0x4634('0x22')]);var _0x34366b=bitmapPackage['arrayWithImage'](_0x4879f4['data'],_0x4879f4['width'],_0x4879f4['height'],printPageGapType,printPageGapLength*0x64,printDarkness,printSpeed,![]);dzBLE['sendData'](_0x34366b,function(){_0x5efb16();});}});}function setItemOrientation(_0x16c7c3){if(_0x16c7c3!=0x0&&_0x16c7c3!=0x5a&&_0x16c7c3!=0xb4&&_0x16c7c3!=0x10e){return;}itemOrientation=_0x16c7c3;}function setItemHorizontalAlignment(_0x5bfbc3){if(_0x5bfbc3!=0x0&&_0x5bfbc3!=0x1&&_0x5bfbc3!=0x2){return;}itemHorizontalAlignment=_0x5bfbc3;}function setItemVerticalAlignment(_0x743002){if(_0x743002!=0x0&&_0x743002!=0x1&&_0x743002!=0x2){return;}itemVerticalAlignment=_0x743002;}function drawText(_0x163eb9,_0x1bcb9d,_0x2d613d,_0x21fc54){canvas[_0x4634('0x24')](covert(_0x21fc54));switch(itemHorizontalAlignment){case 0x0:{canvas['setTextAlign'](_0x4634('0x3'));break;}case 0x1:{canvas[_0x4634('0x12')](_0x4634('0x21'));break;}case 0x2:{canvas[_0x4634('0x12')](_0x4634('0x16'));break;}default:break;}canvas[_0x4634('0x17')](_0x163eb9,covert(_0x1bcb9d),covert(_0x2d613d));}function drawBarcode(_0x90b277,_0x3e780c,_0x434b8a,_0x5ca55b,_0x67e8de){_0x3e780c=covert(_0x3e780c);_0x434b8a=covert(_0x434b8a);_0x5ca55b=covert(_0x5ca55b);_0x67e8de=covert(_0x67e8de);canvas['save']();switch(itemOrientation){case 0x1:case 0x5a:{canvas['rotate'](Math['PI']/0x2);canvas[_0x4634('0xe')](parseInt(_0x434b8a-_0x3e780c),parseInt(-_0x3e780c-_0x434b8a-_0x5ca55b));var _0x167816=_0x5ca55b;_0x5ca55b=_0x67e8de;_0x67e8de=_0x167816;break;}case 0x2:case 0xb4:{canvas['rotate'](Math['PI']);canvas[_0x4634('0xe')](parseInt(-_0x3e780c*0x2-_0x5ca55b),parseInt(-_0x434b8a*0x2-_0x67e8de));break;}case 0x3:case 0x10e:{canvas['rotate'](-Math['PI']/0x2);canvas[_0x4634('0xe')](parseInt(-_0x3e780c-_0x434b8a-_0x67e8de),parseInt(_0x3e780c-_0x434b8a));var _0x167816=_0x5ca55b;_0x5ca55b=_0x67e8de;_0x67e8de=_0x167816;break;}default:break;}barcodeWriter[_0x4634('0x14')](canvas,_0x90b277,_0x3e780c,_0x434b8a,_0x5ca55b,_0x67e8de);canvas[_0x4634('0xb')]();}function drawQRCode(_0x1d92c3,_0x279caa,_0x3dff28,_0x308a9d,_0x522bae){_0x279caa=covert(_0x279caa);_0x3dff28=covert(_0x3dff28);_0x308a9d=covert(_0x308a9d);_0x522bae=covert(_0x522bae);canvas['save']();switch(itemOrientation){case 0x1:case 0x5a:{canvas[_0x4634('0x20')](Math['PI']/0x2);canvas['translate'](parseInt(_0x3dff28-_0x279caa),parseInt(-_0x279caa-_0x3dff28-_0x308a9d));var _0x40c6d7=_0x308a9d;_0x308a9d=_0x522bae;_0x522bae=_0x40c6d7;break;}case 0x2:case 0xb4:{canvas[_0x4634('0x20')](Math['PI']);canvas[_0x4634('0xe')](parseInt(-_0x279caa*0x2-_0x308a9d),parseInt(-_0x3dff28*0x2-_0x522bae));break;}case 0x3:case 0x10e:{canvas[_0x4634('0x20')](-Math['PI']/0x2);canvas['translate'](parseInt(-_0x279caa-_0x3dff28-_0x522bae),parseInt(_0x279caa-_0x3dff28));var _0x40c6d7=_0x308a9d;_0x308a9d=_0x522bae;_0x522bae=_0x40c6d7;break;}default:break;}barcodeWriter[_0x4634('0x7')](canvas,_0x1d92c3,_0x279caa,_0x3dff28,_0x308a9d,_0x522bae);canvas['restore']();}function drawLine(_0x302514,_0x19fd98,_0x3945cc,_0x57a3e7){drawRectangle(_0x302514,_0x19fd98,_0x3945cc,_0x57a3e7,0x0,!![]);}function drawRectangle(_0x1f75ea,_0x4740ac,_0x250fdd,_0x321fc3,_0x24627a,_0x3906a8){_0x1f75ea=covert(_0x1f75ea);_0x4740ac=covert(_0x4740ac);_0x250fdd=covert(_0x250fdd);_0x321fc3=covert(_0x321fc3);_0x24627a=covert(_0x24627a);canvas[_0x4634('0xd')]();switch(itemOrientation){case 0x1:case 0x5a:{canvas['rotate'](Math['PI']/0x2);canvas[_0x4634('0xe')](parseInt(_0x4740ac-_0x1f75ea),parseInt(-_0x1f75ea-_0x4740ac-_0x250fdd));var _0x36f8d9=_0x250fdd;_0x250fdd=_0x321fc3;_0x321fc3=_0x36f8d9;break;}case 0x2:case 0xb4:{canvas[_0x4634('0x20')](Math['PI']);canvas[_0x4634('0xe')](parseInt(-_0x1f75ea*0x2-_0x250fdd),parseInt(-_0x4740ac*0x2-_0x321fc3));break;}case 0x3:case 0x10e:{canvas[_0x4634('0x20')](-Math['PI']/0x2);canvas['translate'](parseInt(-_0x1f75ea-_0x4740ac-_0x321fc3),parseInt(_0x1f75ea-_0x4740ac));var _0x36f8d9=_0x250fdd;_0x250fdd=_0x321fc3;_0x321fc3=_0x36f8d9;break;}default:break;}canvas['setLineWidth'](_0x24627a);if(_0x3906a8){canvas[_0x4634('0x23')]('black');canvas[_0x4634('0x8')](_0x1f75ea,_0x4740ac,_0x250fdd,_0x321fc3);}else{canvas['strokeRect'](_0x1f75ea,_0x4740ac,_0x250fdd,_0x321fc3);}canvas['restore']();}module['exports']={'setPrintPageGapType':setPrintPageGapType,'setPrintPageGapLength':setPrintPageGapLength,'setPrintDarkness':setPrintDarkness,'setPrintSpeed':setPrintSpeed,'setSupportPrefixs':setSupportPrefixs,'connectingPrinterName':connectingPrinterName,'scanedPrinters':scanedPrinters,'openPrinter':openPrinter,'initLPAPI':initLPAPI,'connectingPrinterDetailInfos':connectingPrinterDetailInfos,'closePrinter':closePrinter,'startDrawLabel':startDrawLabel,'endDrawLabel':endDrawLabel,'print':print,'setItemOrientation':setItemOrientation,'setItemHorizontalAlignment':setItemHorizontalAlignment,'setItemVerticalAlignment':setItemVerticalAlignment,'drawText':drawText,'drawBarcode':drawBarcode,'drawQRCode':drawQRCode,'drawLine':drawLine,'drawRectangle':drawRectangle};